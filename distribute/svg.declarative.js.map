{"version":3,"sources":["webpack:///webpack/bootstrap ab5d1239d6398ad0ac79","webpack:///./source/affine.js","webpack:///./source/declarative.js","webpack:///./source/controlled.js","webpack:///./source/controllers.js","webpack:///./source/drawloop.js"],"names":["decompose","compose","mag","a","b","Math","sqrt","unitCircle","thetaRad","atan2","thetaDeg","PI","cos","sin","matrix","cx","cy","c","d","e","f","theta","ct","st","signX","sign","sx","lam","signY","sy","tx","ty","parameters","translateX","translateY","scaleX","scaleY","shear","SVG","Matrix","timer","performance","draw","declarative","invent","parent","Element","create","element","convergenceThreshold","activeController","useLast","nextFrame","targetTime","playSpeed","paused","useAffine","bbox","transformTarget","transform","proposedTransforms","_resetTransformProposal","targets","method","timeout","inputs","affine","get","found","find","item","toOrigin","fromOrigin","transformOrigin","around","construct","controller","chaser","newController","now","extend","pause","state","step","continue","override","should","time","dt","lastTime","convergence","target","inputValues","parameter","newValue","value","push","modified","modifier","methodName","split","frame","bind","speed","newSpeed","matrixC","ox","oy","inverse","center","threshold","newThreshold","delay","_addTarget","initials","waitFor","max","cancelTimeout","argumentsControlled","init","i","length","start","undefined","controlled","methodArgument","newTarget","_bakeTransforms","translation","rotation","scale","flip","skew","multiply","_attrStyle","key","type","obj","hasOwnProperty","startValue","attr","style","x","relative","G","control","currentX","y","currentY","move","oX","width","oY","height","rotate","s","translate","position","isFinite","direction","lamX","lamY","fill","color","opacity","stroke","lineCap","dashArray","controllers","spring","Control","ConstantC","constant","NumberC","reset","currentTarget","Number","error","velocity","acceleration","integral","sNew","vNew","aNew","newError","abs","MatrixC","currentMatrix","toggled","Boolean","v","forEach","number","map","concat","values","ArrayC","string","colorString","numbers","StringC","template","replace","window","match","ColorC","Array","parseInt","hexMatch","regex","hex","rgbMatch","rgb","splice","floor","valueString","join","rgbString","isHex","test","isRgb","arguments","matches","settleTime","overshoot","eps","os","zeta","log","wn","D","K","DrawLoop","nextDraw","frames","timeouts","frameCount","timeoutCount","id","run","requestAnimationFrame","_draw","iSplice","thisId","index","findIndex","t","iStopTimeouts","runTimeouts","iFirst","iStopFrames","runFrames"],"mappings":"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","file":"svg.declarative.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ab5d1239d6398ad0ac79","\nfunction mag (a, b) {\n    return Math.sqrt(a * a + b * b)\n}\n\nfunction unitCircle (a, b) {\n    let thetaRad = Math.atan2(b, a)\n    let thetaDeg = thetaRad * 180 / Math.PI\n    let cos = Math.cos(thetaRad)\n    let sin = Math.sin(thetaRad)\n    return [thetaDeg, cos, sin]\n}\n\nexport function decompose (matrix, cx, cy) {\n\n    // Get the paramaters of the current matrix\n    let {a, b, c, d, e, f} = matrix\n\n    // Construct the parameters\n    let [theta, ct, st] = unitCircle (a, b)\n    let signX = Math.sign(a * ct + b * st)\n    let sx = signX * mag (a, b)\n    let lam = (st * d + ct * c) / (ct * a + st * b)\n    let signY = Math.sign(- c * st + d * ct)\n    let sy = mag (lam * a - c, d - lam * b)\n    let tx = e - cx + cx * ct * sx + cy * (lam * ct * sx - st * sy)\n    let ty = f - cy + cx * st * sx + cy * (lam * st * sx + ct * sy)\n\n    // Package and return the parameters\n    let parameters = {\n        translateX: tx,\n        translateY: ty,\n        theta: theta,\n        scaleX: sx,\n        scaleY: sy,\n        shear: lam,\n    }\n    return parameters\n}\n\nexport function compose (tx, ty, theta, sx, sy, lam, cx, cy) {\n\n    // Calculate the trigonometric values\n    let [ct, st] = [Math.cos(theta * Math.PI / 180),\n                    Math.sin(theta * Math.PI / 180)]\n\n    // Calculate the matrix components directly\n    let a = sx * ct\n    let b = sx * st\n    let c = lam * sx * ct - sy * st\n    let d = lam * sx * st + sy * ct\n    let e = - sx * ct * (cx + cy * lam) + sy * st * cy + tx + cx\n    let f = - sx * st * (cx + cy * lam) - sy * ct * cy + ty + cy\n\n    // Construct a new matrix and return it\n    let matrix = new SVG.Matrix([a, b, c, d, e, f])\n    return matrix\n}\n\n\n\n// WEBPACK FOOTER //\n// ./source/affine.js","\nimport {compose, decompose} from \"declarative/affine\"\nimport Control from \"declarative/controlled\"\nimport {spring} from \"declarative/controllers\"\nimport {DrawLoop} from \"declarative/drawloop\"\n\nlet timer = performance\nlet draw = new DrawLoop()\n\nSVG.declarative = SVG.invent({\n\n    parent: SVG.Element\n\n,   create: function (element) {\n\n        // Store the element\n        this.element = element\n\n        // The controller is in charge of moving our object towards its\n        // desired state directly.\n        this.convergenceThreshold = 1e-6\n        this.activeController = null\n        this.useLast = true\n        this.nextFrame = null\n        this.targetTime = null\n        this.playSpeed = 1\n        this.paused = false\n\n        // Keep track of the state that we want our object to be in\n        this.useAffine = true\n        let {cx, cy} = element.bbox()\n        this.transformTarget = element.transform().matrix\n        this.proposedTransforms = {}\n        this._resetTransformProposal()\n        this.targets = [\n\n            // A target should have the following format. Note that\n            // modifiers are functions that take the inputs and return them\n            // in a format suitable for the method\n            //\n            // {\n            //      methodName (attr_fill, style_width, cx, cy, ...)\n            //      modifier: function\n            //      inputs: [\n            //          any class from controlled\n            //      ]\n            // }\n            { // Transformations\n                method: \"transform\",\n                timeout: null,\n                inputs: [\n                    Control(this.transformTarget, cx, cy)\n                        .affine(this.useAffine)\n                ],\n            },\n        ]\n        this.targets.get = function (method) {\n            let found = this.find(item=> item.method == method)\n            return found\n        }\n\n        // Set the transformation origin for absolute transforms\n        this.toOrigin = null\n        this.fromOrigin = null\n        this.transformOrigin = null\n        this.around(cx, cy)\n    }\n\n,   construct: {\n\n        declarative: function (controller) {\n\n            if (this.chaser) {\n\n                if (controller)\n                    this.chaser.controller(newController)\n\n            } else {\n                this.chaser = new SVG\n                    .declarative(this)\n                    .controller(controller)\n            }\n\n            // Set the time for the next tick\n            this.chaser.targetTime = timer.now()\n            return this.chaser\n        }\n    }\n\n,   extend: {\n\n    /**\n     * Methods that directly modify the simulation\n     */\n\n        pause: function (state=true) {\n            this.paused = state\n            if (this.paused == false)\n                this.step()\n            return this\n        }\n\n    ,   continue: function () {\n            if (this.paused) return\n            if (!this.nextFrame)\n                this.step()\n            return this\n        }\n\n    ,   override: function (should=true) {\n            this.useLast = should\n            return this\n        }\n\n    ,   step: function (time) {\n\n            // If we are paused, just exit\n            if (this.paused) return\n\n            // Get the time delta\n            let dt = this.playSpeed * ((time - this.lastTime) || 16) / 1000\n            dt = dt < 0.1 ? dt : 0.016 // If we missed alot of time, ignore\n            this.lastTime = time\n\n            // Loop through all of the targets and update them based on\n            // the controllers input instruction\n            let convergence = 0\n            let controller = this.activeController\n            for (let target of this.targets) {\n\n                // Loop through all of the controllers and update them\n                let inputValues = []\n                for (let parameter of target.inputs) {\n                    convergence += parameter.step(controller, dt)\n                    let newValue = parameter.value()\n                    inputValues.push(newValue)\n                }\n\n                // Call the modifier to get the parameters in the right\n                // format for the method\n                let modified = inputValues\n                if (target.modifier) {\n                    modified = target.modifier(inputValues)\n                }\n\n                // Call the correct method on the target object\n                let methodName = target.method.split(\"_\")[0]\n                this.element[methodName](...modified)\n            }\n\n            // Get the next animation frame to keep the simulation going\n            if (convergence > this.convergenceThreshold)\n                this.nextFrame = draw.frame(this.step.bind(this))\n            else this.nextFrame = null\n            return this\n        }\n\n    ,   speed: function (newSpeed) {\n            this.playSpeed = newSpeed\n            return this\n        }\n\n    ,   controller: function (newController= spring()) {\n            this.activeController = newController\n            return this\n        }\n\n    ,   affine: function (useAffine=true) {\n\n            // If useAffine is true, transformations will occur in an\n            // affine manner, otherwise, we will directly morph abcdef\n            this.useAffine = useAffine\n            let [matrixC] = this.targets.get(\"transform\").inputs\n            matrixC.affine(useAffine)\n            return this\n        }\n\n    ,   around: function (ox, oy) {\n\n        // Sets the transformation origin explicitly, by default, the\n        // transform origin is around the center of the bbox\n        this.transformOrigin = [ox, oy]\n        this.fromOrigin = new SVG.Matrix([1, 0, 0, 1, ox, oy])\n        this.toOrigin = this.fromOrigin.inverse()\n\n        // Also change the origin for the matrix controller\n        let [matrixC] = this.targets.get(\"transform\").inputs\n        matrixC.center(ox, oy)\n        return this\n    }\n\n    ,   threshold: function (newThreshold) {\n            this.threshold = newThreshold\n            return this\n        }\n\n    ,   delay: function (time) {\n            this.targetTime += time / this.playSpeed\n            return this\n        }\n\n    /**\n     * Methods that modify the current targets\n     */\n\n    ,   _addTarget: function (\n            method, targets=[], initials=()=>[], modifier\n        ) {\n\n            // Work out when to continue\n            let waitFor = Math.max(0, this.targetTime - timer.now())\n            let target = this.targets.get(method)\n\n            // If the target already exists, delete its timeout\n            if (target) {\n                if (this.useLast) draw.cancelTimeout(target.timeout)\n\n            // If the target doesn't exist, we have to check if it\n            // is possible to control and if so, assign it a controller\n            } else {\n\n                // Loop through all of the inputs, and if they are\n                // numeric then we have to make them into controllers\n                let argumentsControlled = []\n                let init = initials()\n                for (let i = 0 ; i < targets.length ; i++) {\n                    let start = init[i] === undefined\n                        ? targets[i]\n                        : init[i]\n                    let controlled = Control(start)\n                    argumentsControlled.push(controlled)\n                }\n\n                // Construct the target for this method\n                target = {\n                    method: method,\n                    inputs: argumentsControlled,\n                    modifier: modifier,\n                }\n                this.targets.push (target)\n            }\n\n            // Wait for the correct time then change the targets\n            target.timeout = draw.timeout(()=> {\n\n                // Set the new targets provided directly\n                for (let i = 0 ; i < targets.length; i++) {\n                    let methodArgument = target.inputs[i]\n                    let newTarget = targets[i]\n                    methodArgument.target(newTarget)\n                }\n\n                // Continue the animation in case it stopped\n                this.continue()\n\n            }, waitFor)\n        }\n\n    ,   _bakeTransforms: function () {\n\n            // Calculate the net matrix\n            let {\n                translation, rotation, scale, flip, skew\n            } = this.proposedTransforms\n            this.transformTarget = translation\n                .multiply(this.fromOrigin)\n                .multiply(rotation)\n                .multiply(scale)\n                .multiply(flip)\n                .multiply(skew)\n                .multiply(this.toOrigin)\n\n            // Add the target for the new transform\n            this._addTarget(\"transform\", [this.transformTarget])\n        }\n\n    ,   _resetTransformProposal: function () {\n\n            this.proposedTransforms = {\n                translation: new SVG.Matrix(),\n                rotation: new SVG.Matrix(),\n                scale: new SVG.Matrix(),\n                flip: new SVG.Matrix(),\n                skew: new SVG.Matrix(),\n            }\n        }\n\n    ,   _attrStyle: function (key, value, type) {\n\n            if (typeof key == 'object') {\n\n                // We are dealing with an object, so loop over it\n                let obj = key\n\n                // Iterate over the keys and values and run them\n                for (let key in obj) if (obj.hasOwnProperty(key)) {\n                    this[type](key, obj[key])\n                }\n\n            } else {\n                let startValue = ()=> [key, this.element[type](key)]\n                this._addTarget(`${type}_${key}`, [key, value], startValue)\n            }\n        }\n\n    // Properties\n\n    ,   attr: function (key, value) {\n            this._attrStyle(key, value, \"attr\")\n            return this\n        }\n\n    ,   style: function (key, value) {\n            this._attrStyle(key, value, \"style\")\n            return this\n        }\n\n    // Basic movements\n\n    ,   x: function (x, relative) {\n\n            if (this.element instanceof SVG.G) {\n\n                // TODO: Deal with groups by using a transform\n\n            } else {\n\n                // Get the current position for this object\n                let control = this.targets.get(\"x\")\n                let currentX = ()=> control\n                    ? control.inputs[0].target()\n                    : this.element.x()\n\n                // Add an x target directly\n                this._addTarget(\"x\",\n                    [relative ? x + currentX() : x],\n                    currentX)\n            }\n            return this\n        }\n\n    ,   y: function (y, relative) {\n\n            if (this.element instanceof SVG.G) {\n\n                // TODO: Deal with groups by using a transform\n\n            } else {\n\n                // Get the current position for this object\n                let control = this.targets.get(\"y\")\n                let currentY = ()=> control\n                    ? control.inputs[0].target()\n                    : this.element.x()\n\n                // Add a y target directly\n                this._addTarget(\"y\",\n                    [relative ? y + currentY : y],\n                    currentY)\n            }\n            return this\n        }\n\n    ,   move: function (x, y, relative) {\n            this.x(x, relative).y(y, relative)\n            return this\n        }\n\n    ,   cx: function (x, relative) {\n\n            // Get the bounding boxes width to subtract off of the x\n            let oX = this.element.bbox().width / 2\n            this.x(x - oX, relative)\n            return this\n        }\n\n    ,   cy: function (y, relative) {\n\n            // Get the bounding boxes width to subtract off of the x\n            let oY = this.element.bbox().height / 2\n            this.y(y - oY, relative)\n            return this\n        }\n\n    ,   center: function (x, y, relative) {\n            this.cx(x, relative).cy(y, relative)\n            return this\n        }\n\n    // Transformations\n\n    ,   matrix: function (matrix, relative=false) {\n\n            this._resetTransformProposal()\n            this.transformTarget = relative\n                ? this.transformTarget.multiply(matrix)\n                : matrix\n            this._addTarget(\"transform\", [this.transformTarget])\n            return this\n        }\n\n    ,   rotate: function (theta, relative=false) {\n\n            // Calculate the rotation matrix\n            let thetaRad = Math.PI * theta / 180\n            let [c, s] = [Math.cos(thetaRad), Math.sin(thetaRad)]\n            let rotation = new SVG.Matrix([c, s, -s, c, 0 , 0])\n\n            // We set the proposed transform and bake it if necessary,\n            // otherwise, we just apply it as a relative matrix\n            this.proposedTransforms.rotation = rotation\n            if (relative) this.matrix(rotation, relative)\n            else this._bakeTransforms()\n            return this\n        }\n\n    ,   translate: function (x, y, relative=false) {\n\n            // Construct the matrix\n            let translation = new SVG.Matrix([1, 0, 0, 1, x, y])\n\n            // We set the proposed transform and bake it if necessary,\n            // otherwise, we just apply it as a relative matrix\n            this.proposedTransforms.translation = translation\n            if (relative) this.matrix(translation, relative)\n            else this._bakeTransforms()\n            return this\n        }\n\n    ,   position: function (x, y) {\n\n            // Forcibly place the center at the x, y position given\n            let [cx, cy] = this.transformOrigin\n            this.translate(x - cx, y - cy, false)\n            return this\n        }\n\n    ,   scale: function (sx, sy, relative=false) {\n\n            // The user can provide only one scale for a proportional scale\n            if (!isFinite(sy)) {\n                relative = sy || relative\n                sy = sx\n            }\n\n            // Build the scale matrix\n            let scale = new SVG.Matrix([sx, 0, 0, sy, 0, 0])\n\n            // We set the proposed transform and bake it if necessary,\n            // otherwise, we just apply it as a relative matrix\n            this.proposedTransforms.scale = scale\n            if (relative) this.matrix(scale, relative)\n            else this._bakeTransforms()\n            return this\n        }\n\n    ,   flip: function (direction=\"x\", relative=false) {\n\n            // Build the flip matrix\n            if (relative) {\n                let flip = new SVG.Matrix()\n                flip[direction == \"x\" ? \"a\" : \"d\"] = -1\n                this.matrix(scale, relative)\n\n            } else {\n\n                // Flip the respective entry in the flip matrix\n                this.proposedTransforms\n                    .flip[direction == \"x\" ? \"a\" : \"d\"] *= -1\n                this._bakeTransforms()\n            }\n            return this\n        }\n\n    ,   skew: function (lamX, lamY, relative=false) {\n\n            // The user can provide only one skew for a proportional skew\n            if (!isFinite(sy)) {\n                relative = lamY || relative\n                lamY = lamX\n            }\n\n            // Calculate the skew matrix\n            let skew = new SVG.Matrix([1, lamY, lamX, 1, 0, 0])\n\n            // Modify the current matrix\n            this.proposedTransforms.skew = skew\n            if (relative) this.matrix(skew, relative)\n            else this._bakeTransforms()\n            return this\n        }\n\n    // Syntax Sugar\n\n    ,   fill: function (item) {\n\n            // Strings are always assumed to be fills\n            if (typeof item == \"string\") {\n\n                this.attr(\"fill\", item)\n\n            // If we have an object, set the individual attributes\n            } else if (typeof item == \"object\") {\n\n                if(item.color)\n                    this.attr(\"fill\", item.color)\n\n                if(item.opacity)\n                    this.attr(\"fill-opacity\", item.opacity)\n            }\n            return this\n        }\n\n    ,   stroke: function (item) {\n\n            // If we have an object, set the individual attributes\n            if (typeof item == \"string\") {\n\n                this.attr(\"stroke\", item)\n\n            } else if (typeof item == \"object\") {\n\n                if(item.color)\n                    this.attr(\"stroke\", item.color)\n\n                if(item.opacity)\n                    this.attr(\"stroke-opacity\", item.opacity)\n\n                if(item.width)\n                    this.attr(\"stroke-width\", item.width)\n\n                if(item.lineCap)\n                    this.attr(\"stroke-linecap\", item.lineCap)\n\n                if(item.dashArray)\n                    this.attr(\"stroke-dasharray\", item.dashArray)\n            }\n            return this\n        }\n\n    ,   width: function (item) {\n            this.attr(\"width\", item)\n            return this\n        }\n\n    ,   height: function (item) {\n            this.attr(\"height\", item)\n            return this\n        }\n    }\n})\n\nSVG.controllers = {\n    spring: spring,\n}\n\n\n\n// WEBPACK FOOTER //\n// ./source/declarative.js","\nimport {compose, decompose} from \"declarative/affine\"\n\n\nclass ConstantC {\n    constructor (value) {\n        this.target(value)\n    }\n\n    target (value) {\n        this.constant = value\n    }\n\n    value () {\n        return this.constant\n    }\n\n    step (controller, dt) {\n        return 0\n    }\n}\n\n\nclass NumberC {\n\n    constructor (target) {\n        this.reset(target)\n    }\n\n    target (newTarget) {\n        if (isFinite(newTarget)) {\n            this.currentTarget = Number(newTarget)\n            this.error = this.position - this.currentTarget\n        }\n        return this.currentTarget\n    }\n\n    value () {\n        return this.position\n    }\n\n    step (controller, dt) {\n\n        // Use the controller to determine what the new parameters should be\n        let [sNew, vNew, aNew] = controller(\n            this.error, this.velocity, this.acceleration, this.integral)\n        this.position = isFinite(sNew) ? sNew : this.position\n        this.velocity = isFinite(vNew) ? vNew : this.velocity\n        this.acceleration = isFinite(aNew) ? aNew : this.acceleration\n\n        // Use Eulers method to update the velocity and the error\n        this.position += this.velocity * dt + this.acceleration * dt * dt / 2\n        this.velocity += this.acceleration * dt\n\n        // Use the position to calculate the new error and its integral\n        let newError = this.position - this.currentTarget\n        this.integral += dt * (this.error +  newError) / 2 // Trapezoidal rule\n        this.error = newError\n\n        // If the controller isn't doing anything, we consider it converged\n        let convergence = Math.abs((sNew || 0) + (vNew || 0) + (aNew || 0))\n        return convergence\n    }\n\n    reset (newValue) {\n        this.currentTarget = Number(newValue)\n        this.position = Number(newValue)\n        this.error = 0\n        this.velocity = 0\n        this.acceleration = 0\n        this.integral = 0\n    }\n}\n\n\nclass MatrixC {\n\n    constructor (matrix= new SVG.Matrix(), cx= 0, cy= 0) {\n\n        // Store all of the parameters\n        this.currentMatrix = matrix\n        this.controllers = [\n            new NumberC(matrix.a), new NumberC(matrix.b),\n            new NumberC(matrix.c), new NumberC(matrix.d),\n            new NumberC(matrix.e), new NumberC(matrix.f)\n        ]\n\n        // If we want an affine transformation, we find the parameters\n        this.cx = cx\n        this.cy = cy\n        this.useAffine = false // If true, it will be set below\n    }\n\n    center (cx, cy) {\n        this.cx = cx\n        this.cy = cy\n        return this\n    }\n\n    affine (useAffine=true) {\n\n        // Work out if we need to modify the targets\n        let toggled = Boolean(this.useAffine ^ useAffine)\n        this.useAffine = useAffine\n\n        // Convert the targets to affine or vice versa\n        if (toggled) this.target(this.currentMatrix, true)\n        return this\n    }\n\n    target (matrix, reset=false) {\n\n        // Extract the parameters\n        let v = null\n        if (this.useAffine) {\n\n            // Decompose the matrix into its parameters\n            let {\n                translateX, translateY, theta, scaleX, scaleY, shear\n            } = decompose(matrix, this.cx, this.cy)\n            v = [translateX, translateY, theta, scaleX, scaleY, shear]\n\n        } else {\n            v = [matrix.a, matrix.b, matrix.c, matrix.d, matrix.e, matrix.f]\n        }\n\n        // Set the new target for each controller\n        this.controllers.forEach((c, i)=> c[reset ? \"reset\" : \"target\"](v[i]))\n    }\n\n    value () {\n        return this.currentMatrix\n    }\n\n    step (controller, dt) {\n\n        // Step through all of the numbers, updating them\n        let convergence = 0\n        for (let number of this.controllers) {\n            convergence += number.step(controller, dt)\n        }\n\n        // Extract the current matrix from this\n        if (this.useAffine) {\n\n            // Get the affine parameters and add on the center point\n            let parameters = this.controllers\n                .map(c=> c.value())\n                .concat([this.cx, this.cy])\n\n            // Compose the affine parameters into a matrix\n            this.currentMatrix = compose(...parameters)\n\n        } else {\n\n            // If we are not using affine transforms, just return directly\n            let values = this.controllers.map(c=> c.value())\n            this.currentMatrix = new SVG.Matrix(values)\n        }\n\n        // Return the convergence error\n        return convergence\n    }\n}\n\n\nclass ArrayC {\n\n    constructor (string) {\n    }\n\n    target (colorString) {\n    }\n\n    value () {\n    }\n\n    step (controller, dt) {\n    }\n\n    static matches (item) {\n    }\n}\n\n\n// TODO: Allow svg d elements to animate by picking out their numbers and\n// replacing them all\nlet numbers = /[-+]?[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?/i\nclass StringC {\n\n    construct (string) {\n\n        //\n        this.values = []\n        this.template = string.replace(numbers, match=> {\n\n            // Parse the match as a number\n            let value = window.Number(match)\n            let controller = new Number()\n            return \"__v__\"\n        })\n    }\n\n    target (colorString) {\n    }\n\n    value () {\n    }\n\n    step (controller, dt) {\n    }\n\n    static matches (item) {\n    }\n}\n\n\nclass ColorC {\n\n    constructor (string) {\n        this.targets = [new NumberC (0), new NumberC (0), new NumberC (0)]\n        this.target(string)\n    }\n\n    target (color) {\n\n        // Get the new values from the color\n        let values = null\n        if (color instanceof Array) {\n            values = color.map(v=> parseInt(v))\n\n        } else if (typeof color == \"string\") {\n\n            let hexMatch = color.match(SVG.regex.hex)\n            let rgbMatch = color.match(SVG.regex.rgb)\n            values = hexMatch\n                ? hexMatch.splice(1).map(v=> parseInt(v, 16))\n                : rgbMatch.splice(1).map(v=> parseInt(v))\n\n        } else return\n\n        // Set the new targets\n        this.targets.forEach((target, i)=> target.target(values[i]))\n\n        // Return the values for use\n        return values\n    }\n\n    value () {\n\n        // Get the numbers and bound them to an int between [0, 255]\n        let values = this.targets.map(v=> {\n            let value = Math.floor(v.value())\n            value = value < 0 ? 0\n                : value > 255 ? 255\n                : value\n            return value\n        })\n        let valueString = values.join(\", \")\n        let rgbString = `rgb(${valueString})`\n        return rgbString\n    }\n\n    step (controller, dt) {\n        let convergence = 0\n        for (let target of this.targets)\n            convergence += target.step(controller, dt)\n        return convergence\n    }\n\n    static matches (item) {\n        if (typeof item !== \"string\") return false\n        let isHex = SVG.regex.isHex.test(item)\n        let isRgb = SVG.regex.isRgb.test(item)\n        return isRgb || isHex\n    }\n}\n\n\nexport default function Control (value) {\n\n    // If we have any of the correct types, then we should control them\n    if (value instanceof SVG.Matrix)\n        return new MatrixC(...arguments)\n    else if (ColorC.matches(value))\n        return new ColorC(...arguments)\n    else if (isFinite(value))\n        return new NumberC(...arguments)\n    else return new ConstantC(...arguments)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./source/controlled.js","\nexport function spring ({\n    settleTime=500,\n    overshoot=15,\n}={}) {\n\n    // Calculate the PID natural response\n    let eps = 1e-10\n    let os = overshoot / 100 + eps\n    let zeta = - Math.log(os) / Math.sqrt(Math.PI ** 2 + Math.log(os) ** 2)\n    let wn = 4 / (zeta * settleTime / 1000)\n\n    // Calculate the Spring values\n    let D = 2 * zeta * wn\n    let K = wn * wn\n\n    // Return the acceleration required\n    return function (error, velocity, acceleration, integral) {\n        let control = - D * velocity - K * error\n        return [,, control]\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./source/controllers.js","\nexport class DrawLoop {\n\n    constructor () {\n        this.nextDraw = null\n        this.frames = []\n        this.timeouts = []\n        this.frameCount = 0\n        this.timeoutCount = 0\n        this.timer = performance\n    }\n\n    frame (method) {\n        this.frames.push({\n            id: this.frameCount,\n            run: method\n        })\n        if (this.nextDraw === null)\n            this.nextDraw = requestAnimationFrame(this._draw.bind(this))\n        return this.frameCount++\n    }\n\n    timeout (method, delay=0) {\n\n        // Work out when the event should fire\n        let time = this.timer.now() + delay\n\n        // Find the first time lower than the required time\n        let iSplice = this.timeouts.length\n        for (; iSplice > 0; iSplice--)\n            if (this.timeouts[iSplice - 1].time < time) break\n\n        // Insert the timeout there directly\n        let thisId = this.timeoutCount++\n        this.timeouts.splice(iSplice, 0, {\n            id: thisId,\n            run: method,\n            time: time,\n        })\n        if (this.nextDraw === null)\n            this.nextDraw = requestAnimationFrame(this._draw.bind(this))\n        return thisId\n    }\n\n    cancelTimeout (id) {\n\n        // Find the index of the timeout to cancel and remove it\n        let index = this.timeouts.findIndex(t=> t.id == id)\n        if (index >= 0) this.timeouts.splice(index, 1)\n    }\n\n    _draw (now) {\n\n        /**\n         * Dealing with timeouts\n         */\n\n        // Figure out the final index to run till\n        let iStopTimeouts = this.timeouts.findIndex(t => t.time > now)\n        if (iStopTimeouts == -1) iStopTimeouts == this.timeouts.length\n\n        // Take out the timeouts that should run\n        let runTimeouts = this.timeouts\n        this.timeouts = this.timeouts.splice(iStopTimeouts)\n\n        // Run the timeouts directly\n        for (let timeout of runTimeouts)\n            timeout.run()\n\n        /**\n         * Dealing with frames\n         */\n\n        if (this.frames.length) {\n\n            // Figure out which frames should fire\n            let iFirst = this.frames[0].id\n            let iStopFrames = this.frameCount - iFirst + 1\n\n            // Take out the frames that should fire\n            let runFrames = this.frames\n            this.frames = this.frames.splice(iStopFrames)\n\n            // Execute the animation frames and empty this.nextDraw\n            for (let frame of runFrames)\n                frame.run(now)\n        }\n\n        // If we have remaining timeouts, loop until we don't\n        this.nextDraw = this.timeouts.length > 0 && this.frames.length > 0\n            ? requestAnimationFrame(this._draw.bind(this))\n            : null\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./source/drawloop.js"],"sourceRoot":""}